<div id='cursor-container'>
  <div
    id='inner-cursor'
    style={{ transition: 'width .2s, height .2s' }}
    class='fixed -left-4 top-0 -translate-x-1/2 -translate-y-1/2 z-50 w-3 h-3 rounded-full pointer-events-none bg-gray-300'
  >
  </div>
  <div
    id='outer-cursor'
    class='fixed -left-4 top-0 -translate-x-1/2 -translate-y-1/2 z-50 w-8 h-8 border-2 rounded-full pointer-events-none border-neutral-700'
  >
  </div>
</div>
<script>
  import { settings } from '../stores/settings'

  const container = document.querySelector('#cursor-container') as HTMLElement
  const inner = document.querySelector('#inner-cursor') as HTMLElement
  const outer = document.querySelector('#outer-cursor') as HTMLElement

  const handleMouseMove = (e: MouseEvent) => {
    let x = e.clientX
    let y = e.clientY
    outer.style.left = x + 'px'
    outer.style.top = y + 'px'
    inner.style.top = y + 'px'
    inner.style.left = x + 'px'
  }

  const handleMouseDown = () => {
    outer.style.width = '2.75rem'
    inner.style.width = '.25rem'
    outer.style.height = '2.75rem'
    inner.style.height = '.25rem'
  }

  const handleMouseUp = () => {
    outer.style.width = ''
    inner.style.width = ''
    outer.style.height = ''
    inner.style.height = ''
  }

  const addCursor = () => {
    document.addEventListener('mousemove', handleMouseMove)
    document.addEventListener('mousedown', handleMouseDown)
    document.addEventListener('mouseup', handleMouseUp)
    container.style.display = ''
  }

  const removeCursor = () => {
    document.removeEventListener('mousemove', handleMouseMove)
    document.removeEventListener('mousedown', handleMouseDown)
    document.removeEventListener('mouseup', handleMouseUp)
    container.style.display = 'none'
  }

  settings.subscribe((v) => (v.cursor ? addCursor() : removeCursor()))
</script>
